<!-- https://yourname.github.io/dapp/connect.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>è¿æ¥ TronLink</title>
</head>
<body style="padding:20px; font-family:sans-serif;">
  <h2>ğŸ” è¿æ¥é’±åŒ…</h2>
  <button id="connectBtn" onclick="connect()">ğŸ”Œ è¿æ¥ TronLink</button>
  <div id="status" style="margin-top:15px;"></div>

  <script>
    async function connect() {
      const status = document.getElementById('status');
      
      // 1. å…ˆæ£€æŸ¥æ˜¯å¦å·²åœ¨ TronLink æµè§ˆå™¨ä¸­
      if (typeof window.tronWeb !== 'undefined') {
        try {
          const address = await window.tronWeb.defaultAddress.base58;
          status.innerHTML = `âœ… å·²è¿æ¥ï¼š<br>${address}`;
          return;
        } catch (e) {
          status.innerText = 'âŒ è·å–åœ°å€å¤±è´¥';
        }
      }

      // 2. å¦‚æœåœ¨å¤–éƒ¨æµè§ˆå™¨ï¼Œå°è¯•å”¤èµ· TronLink
      status.innerText = 'æ­£åœ¨å”¤èµ· TronLink...';

      // æ„é€ å®˜æ–¹æ¨èçš„è¿æ¥é“¾æ¥ï¼ˆå…³é”®ï¼ï¼‰
      const dappUrl = encodeURIComponent(window.location.href);
      const tronLinkConnectUrl = `https://tronscan.org/tronlink/connect?dappUrl=${dappUrl}`;

      // æ–¹å¼ Aï¼šç›´æ¥è·³è½¬åˆ° Tronscan ä¸­è½¬é¡µï¼ˆæœ€å¯é ï¼‰
      window.location.href = tronLinkConnectUrl;

      // æ–¹å¼ Bï¼ˆå¤‡ç”¨ï¼‰ï¼šå°è¯•æ·±åº¦é“¾æ¥ï¼ˆéƒ¨åˆ†è®¾å¤‡æœ‰æ•ˆï¼‰
      /*
      const deepLink = `tronlink://connect?dappUrl=${dappUrl}`;
      const iframe = document.createElement('iframe');
      iframe.style.display = 'none';
      iframe.src = deepLink;
      document.body.appendChild(iframe);
      setTimeout(() => window.location.href = deepLink, 300);
      setTimeout(() => document.body.removeChild(iframe), 1000);
      */
    }
  </script>
</body>
</html>
